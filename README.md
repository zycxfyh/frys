# WokeFlow - åŸºäºä¼˜ç§€å¼€æºé¡¹ç›®çš„ç°ä»£åŒ–å·¥ä½œæµç³»ç»Ÿ

## ğŸš€ é¡¹ç›®æ¦‚è¿°

WokeFlow æ˜¯ä¸€ä¸ªåŸºäºä¼˜ç§€å¼€æºé¡¹ç›®çš„ç°ä»£åŒ–å·¥ä½œæµç®¡ç†ç³»ç»Ÿï¼Œé€šè¿‡é›†æˆä¸šç•Œé¢†å…ˆçš„å¼€æºè§£å†³æ–¹æ¡ˆï¼Œæ„å»ºé«˜æ€§èƒ½ã€å¯æ‰©å±•ã€æ˜“ç»´æŠ¤çš„ä¼ä¸šçº§å·¥ä½œæµå¹³å°ã€‚

**æ ¸å¿ƒç‰¹æ€§:**
- âœ… **å¼€æºé©±åŠ¨**: é‡‡ç”¨GitHubä¸Šæœ€ä¼˜ç§€çš„å¼€æºé¡¹ç›®
- âœ… **é«˜æ€§èƒ½**: åŸºäºFastifyå’ŒBull.jsçš„ç°ä»£åŒ–æ¶æ„
- âœ… **å¯è§‚æµ‹æ€§**: é›†æˆSentryé”™è¯¯ç›‘æ§å’Œæ€§èƒ½è¿½è¸ª
- âœ… **æ¨¡å—åŒ–**: åŸºäºAwilixçš„ä¾èµ–æ³¨å…¥æ¶æ„

## ğŸ—ï¸ æ¶æ„æ¦‚è§ˆ

### æ ¸å¿ƒå¼€æºé¡¹ç›®

```
ğŸ”§ ä¾èµ–æ³¨å…¥å®¹å™¨
â””â”€â”€ Awilix - ä¸“ä¸ºNode.jsè®¾è®¡çš„è½»é‡çº§DIå®¹å™¨

ğŸŒ Webæ¡†æ¶ä¸HTTPå®¢æˆ·ç«¯
â”œâ”€â”€ Fastify - é«˜æ€§èƒ½Node.js Webæ¡†æ¶
â”œâ”€â”€ Axios - åŠŸèƒ½å¼ºå¤§çš„HTTPå®¢æˆ·ç«¯
â””â”€â”€ fastify-plugin - Fastifyæ’ä»¶ç³»ç»Ÿ

ğŸ“¨ æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿ
â”œâ”€â”€ Bull.js - åŸºäºRedisçš„å¼ºå¤§ä½œä¸šé˜Ÿåˆ—
â””â”€â”€ IORedis - é«˜æ€§èƒ½Rediså®¢æˆ·ç«¯

ğŸ“¡ äº‹ä»¶ç³»ç»Ÿ
â””â”€â”€ EventEmitter3 - ä¼˜åŒ–çš„Node.jsäº‹ä»¶å‘å°„å™¨

ğŸ›¡ï¸ é”™è¯¯å¤„ç†ä¸ç›‘æ§
â”œâ”€â”€ Sentry - ä¼ä¸šçº§é”™è¯¯ç›‘æ§å’Œæ€§èƒ½è¿½è¸ª
â”œâ”€â”€ @sentry/node - Node.js SDK
â””â”€â”€ @sentry/profiling-node - æ€§èƒ½åˆ†æ

ğŸ¨ çŠ¶æ€ç®¡ç†ä¸å·¥å…·åº“
â”œâ”€â”€ Zustand - è½»é‡çº§ReactçŠ¶æ€ç®¡ç†
â”œâ”€â”€ Lodash - å®ç”¨çš„JavaScriptå·¥å…·åº“
â”œâ”€â”€ UUID - å”¯ä¸€æ ‡è¯†ç¬¦ç”Ÿæˆ
â””â”€â”€ Day.js - è½»é‡çº§æ—¥æœŸå¤„ç†åº“

ğŸ” è®¤è¯ä¸å®‰å…¨
â””â”€â”€ JSON Web Token - ä¸šç•Œæ ‡å‡†çš„è®¤è¯æ–¹æ¡ˆ

ğŸ§ª æµ‹è¯•å·¥å…·é“¾
â”œâ”€â”€ Vitest - å¿«é€Ÿçš„å•å…ƒæµ‹è¯•æ¡†æ¶
â”œâ”€â”€ Testcontainers - é›†æˆæµ‹è¯•å®¹å™¨ç®¡ç†
â””â”€â”€ @testcontainers/postgresql & redis - æ•°æ®åº“æµ‹è¯•å®¹å™¨
```

## ğŸ“Š æ¶æ„ä¼˜åŠ¿

| ç‰¹æ€§ | ä¹‹å‰ (è‡ªå»º) | ç°åœ¨ (å¼€æº) | æ”¹å–„ |
|------|-------------|-------------|------|
| ä¾èµ–æ³¨å…¥ | è‡ªå»ºå®¹å™¨ | Awilix | âœ… æ›´æˆç†Ÿã€æ›´ç¨³å®š |
| Webæ¡†æ¶ | è‡ªå»ºHTTP | Fastify | âœ… é«˜æ€§èƒ½ã€ç”Ÿæ€ä¸°å¯Œ |
| æ¶ˆæ¯é˜Ÿåˆ— | è‡ªå»ºæ¨¡æ‹Ÿ | Bull.js | âœ… ç”Ÿäº§å°±ç»ªã€åŠŸèƒ½å®Œæ•´ |
| äº‹ä»¶ç³»ç»Ÿ | è‡ªå»ºå®ç° | EventEmitter3 | âœ… ä¼˜åŒ–æ€§èƒ½ã€å†…å­˜å®‰å…¨ |
| é”™è¯¯ç›‘æ§ | è‡ªå»ºå¤„ç† | Sentry | âœ… ä¼ä¸šçº§ç›‘æ§ã€æ€§èƒ½åˆ†æ |
| æ’ä»¶ç³»ç»Ÿ | è‡ªå»ºç®¡ç† | fastify-plugin | âœ… æ ‡å‡†åŒ–ã€æ˜“æ‰©å±• |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js >= 16.0.0
- Redis (ç”¨äºæ¶ˆæ¯é˜Ÿåˆ—)
- PostgreSQL (å¯é€‰ï¼Œç”¨äºæ•°æ®å­˜å‚¨)

### å®‰è£…ä¾èµ–
```bash
npm install
```

### é…ç½®ç¯å¢ƒå˜é‡
```bash
# å¤åˆ¶ç¯å¢ƒé…ç½®æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘é…ç½®æ–‡ä»¶
nano .env
```

### å¯åŠ¨ç³»ç»Ÿ
```bash
# å¼€å‘æ¨¡å¼
npm run dev

# ç”Ÿäº§æ¨¡å¼
npm start
```

### å¥åº·æ£€æŸ¥
```bash
curl http://localhost:3000/health
```

## ğŸ“‹ é¡¹ç›®ç»“æ„

```
WokeFlow/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ core/                 # æ ¸å¿ƒç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ container.js      # Awilixä¾èµ–æ³¨å…¥å®¹å™¨
â”‚   â”‚   â”œâ”€â”€ server.js         # Fastify WebæœåŠ¡å™¨
â”‚   â”‚   â”œâ”€â”€ queue.js          # Bull.jsæ¶ˆæ¯é˜Ÿåˆ—
â”‚   â”‚   â”œâ”€â”€ events.js         # EventEmitter3äº‹ä»¶ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ error-handler.js  # Sentryé”™è¯¯å¤„ç†
â”‚   â”‚   â””â”€â”€ plugin-system.js  # fastify-pluginæ’ä»¶ç³»ç»Ÿ
â”‚   â”œâ”€â”€ services/             # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”œâ”€â”€ infrastructure/       # åŸºç¡€è®¾æ–½å±‚
â”‚   â”œâ”€â”€ domain/              # é¢†åŸŸå±‚
â”‚   â””â”€â”€ index.js             # åº”ç”¨å…¥å£
â”œâ”€â”€ tests/                   # æµ‹è¯•ç›®å½•
â”œâ”€â”€ docs/                    # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ package.json             # é¡¹ç›®é…ç½®
â”œâ”€â”€ vitest.config.js         # æµ‹è¯•é…ç½®
â””â”€â”€ README.md               # é¡¹ç›®è¯´æ˜
```

## ğŸ”§ æ ¸å¿ƒç»„ä»¶è¯´æ˜

### ä¾èµ–æ³¨å…¥å®¹å™¨ (Awilix)
```javascript
import { getContainer } from './core/container.js';

// è§£ææœåŠ¡
const workflowEngine = getContainer().resolve('workflowEngine');
```

### WebæœåŠ¡å™¨ (Fastify)
```javascript
import { startServer } from './core/server.js';

// å¯åŠ¨æœåŠ¡å™¨
const server = await startServer(3000);
```

### æ¶ˆæ¯é˜Ÿåˆ— (Bull.js)
```javascript
import { getQueue, createWorker } from './core/queue.js';

// åˆ›å»ºé˜Ÿåˆ—å’Œå·¥ä½œè€…
const queue = getQueue('user-events');
const worker = createWorker('user-events', processor);
```

### äº‹ä»¶ç³»ç»Ÿ (EventEmitter3)
```javascript
import { eventSystem } from './core/events.js';

// ç›‘å¬äº‹ä»¶
eventSystem.on('user.created', handler);

// å‘å°„äº‹ä»¶
eventSystem.emit('user.created', userData);
```

### é”™è¯¯å¤„ç† (Sentry)
```javascript
import { errorHandler } from './core/error-handler.js';

// å¤„ç†é”™è¯¯
await errorHandler.handle(error, { context: 'operation' });
```

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# è¿è¡Œå•å…ƒæµ‹è¯•
npm run test:unit

# è¿è¡Œé›†æˆæµ‹è¯•
npm run test:integration

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage
```

## ğŸ“Š ç›‘æ§ä¸å¯è§‚æµ‹æ€§

### Sentryé”™è¯¯ç›‘æ§
- è‡ªåŠ¨é”™è¯¯æ•è·å’Œä¸ŠæŠ¥
- æ€§èƒ½ç›‘æ§å’Œè¿½è¸ª
- ç”¨æˆ·åé¦ˆæ”¶é›†
- ç‰ˆæœ¬ç®¡ç†å’Œéƒ¨ç½²è¿½è¸ª

### å¥åº·æ£€æŸ¥ç«¯ç‚¹
```bash
GET /health - ç³»ç»Ÿå¥åº·çŠ¶æ€
GET /metrics - PrometheusæŒ‡æ ‡ (å¯é€‰)
```

## ğŸ¯ å¼€å‘ç†å¿µ

**ä¸é‡å¤é€ è½®å­ï¼Œç«™åœ¨å·¨äººçš„è‚©è†€ä¸Š**

- âœ… **å¼€æºä¼˜å…ˆ**: ä¼˜å…ˆé€‰æ‹©æˆç†Ÿçš„å¼€æºè§£å†³æ–¹æ¡ˆ
- âœ… **æœ€ä½³å®è·µ**: éµå¾ªä¸šç•Œçš„æ ‡å‡†å’Œæœ€ä½³å®è·µ
- âœ… **å¯ç»´æŠ¤æ€§**: ä½¿ç”¨å¹¿æ³›é‡‡ç”¨çš„æŠ€æœ¯æ ˆ
- âœ… **æ€§èƒ½ä¼˜åŒ–**: é€‰æ‹©é«˜æ€§èƒ½çš„è§£å†³æ–¹æ¡ˆ

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

### å¼€å‘æµç¨‹
1. Forké¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»ºPull Request

## ğŸ“ è”ç³»æ–¹å¼

- **ç”µè¯**: 17855398215
- **é‚®ç®±**: 1666384464@qq.com

## ğŸ“ è®¸å¯è¯

MIT License

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰å¼€æºé¡¹ç›®çš„è´¡çŒ®è€…ï¼Œæ˜¯ä½ ä»¬çš„åŠªåŠ›è®©è¿™ä¸ªé¡¹ç›®æˆä¸ºå¯èƒ½ï¼

ç‰¹åˆ«æ„Ÿè°¢ï¼š
- [Awilix](https://github.com/jeffijoe/awilix) - ä¼˜ç§€çš„ä¾èµ–æ³¨å…¥å®¹å™¨
- [Fastify](https://github.com/fastify/fastify) - é«˜æ€§èƒ½Webæ¡†æ¶
- [Bull.js](https://github.com/OptimalBits/bull) - å¼ºå¤§çš„ä½œä¸šé˜Ÿåˆ—
- [Sentry](https://github.com/getsentry/sentry) - ä¸“ä¸šçš„é”™è¯¯ç›‘æ§å¹³å°